# ADR-048: Pool-Based Scoring por Runtime

> **Status:** âœ… APROBADA â€” Validada por PO 2026-02-24
> **Date:** 2026-02-23
> **Author:** Arquitecto AICE (sub-agent)
> **Deciders:** Sergio (PO), ComPi (Orquestador)
> **Supersedes:** ADR-047 (Subagent Trust Policy â€” Modelo D con fases)

---

## 1. Contexto

ADR-047 propuso un modelo en fases (Dâ†’Bâ†’completo) con `teamRegistry` centralizado en ComPi y reglas de atribuciÃ³n de culpa. El PO ha evaluado esa propuesta y ha tomado una posiciÃ³n clara que simplifica radicalmente el modelo.

**PosiciÃ³n del PO:**

> "No estoy evaluando el modelo, sino al agente que trabaja con el modelo. La idea es globalizar el scoring a partir de promedios agrupados por modelo+thinking. Lo Ãºnico que me desvÃ­a de un scoring global vs un scoring propio promedio multiagÃ©ntico es la madurez, y en mi caso la madurez sÃ­ es compartida."

**JerarquÃ­a de evaluaciÃ³n:**

```
Sergio (humano, PO)
  â””â”€â”€ evalÃºa â†’ ComPi (opus-4-6|high)          â”€â” Pool: opus-4-6|high
        â””â”€â”€ evalÃºa â†’ Arquitectos (opus-4-6|high) â”€â”˜
              â””â”€â”€ evalÃºan â†’ Backend, Frontend, DataEng, Tester (sonnet-4-5|high) â”€â”€ Pool: sonnet-4-5|high
```

---

## 2. EvaluaciÃ³n TÃ©cnica de la Propuesta del PO

### 2.1 La preocupaciÃ³n de ComPi

> "Un backend brillante y un frontend mediocre compartirÃ­an score. El mal trabajo de uno contamina al otro."

### 2.2 AnÃ¡lisis: Â¿Es un problema real?

**No.** Y explico por quÃ© con un ejemplo concreto:

**Escenario:** Pool `sonnet-4-5|high` con 4 agentes tras 50 evaluaciones cada uno:

| Agente | Score individual | Evaluaciones |
|--------|:---:|:---:|
| Backend | 82% | 50 |
| Frontend | 55% | 50 |
| Data Engineer | 71% | 50 |
| Tester | 78% | 50 |

- **Pool score** (promedio ponderado por evals) = (82Ã—50 + 55Ã—50 + 71Ã—50 + 78Ã—50) / 200 = **71.5%**
- **Pool maturity** = 200 evaluaciones â†’ tier JUNIOR (101-500), CI Â±1.8

**Â¿QuÃ© nos dice el pool score?** Responde a: _"Â¿CuÃ¡nto puedo confiar en un agente sonnet-4-5|high en general?"_ â†’ ~72%. Es una **estadÃ­stica de poblaciÃ³n**, no una evaluaciÃ³n individual.

**Â¿Se pierde informaciÃ³n?** No. Cada agente mantiene su score individual:
- Si quieres saber si el frontend es malo â†’ miras su score individual (55%).
- Si quieres crear un NUEVO sub-agente Sonnet â†’ tu expectativa base es 72% (el pool).
- Si quieres comparar runtimes â†’ opus pool 78% vs sonnet pool 72%.

**AnalogÃ­a real:** Una universidad tiene un rating promedio (el pool). Cada estudiante tiene sus notas (individual). El rating de la universidad no "contamina" las notas del estudiante brillante â€” son mÃ©tricas a distinto nivel.

### 2.3 Â¿Hay algÃºn caso donde esto falle?

He buscado un caso real donde el pooling cause un **problema de decisiÃ³n** (no solo estÃ©tico):

**Caso hipotÃ©tico:** Pool sonnet a 72%. Sergio quiere asignar una tarea crÃ­tica. Â¿ConfÃ­a en el pool o mira el individual?

â†’ Si mira el pool: "72%, aceptable, adelante." Puede caer en el frontend (55%). Riesgo.
â†’ Si mira el individual: "Backend 82%, Frontend 55%. Asigno al Backend." DecisiÃ³n informada.

**Â¿Es esto culpa del pool?** No. El pool es la mÃ©trica correcta para "Â¿puedo confiar en este runtime?". La decisiÃ³n de a QUIÃ‰N asignar usa la mÃ©trica individual. Son preguntas distintas con mÃ©tricas distintas. El pool no pretende responder "Â¿quiÃ©n es mejor?".

**Veredicto: La propuesta del PO tiene sentido tÃ©cnico y prÃ¡ctico. No hay problema real.**

### 2.4 La madurez compartida: Â¿es legÃ­tima?

**SÃ­, y es el argumento mÃ¡s fuerte del PO.**

Maturity responde a: _"Â¿CuÃ¡nto puedo fiarme de ESTE score?"_. Si 5 agentes Sonnet generan 50 evals/dÃ­a en total, tengo 50 data points sobre cÃ³mo rinde `sonnet-4-5|high`. Mi confianza en el pool score ES alta porque tengo mucha evidencia.

**CÃ¡lculo comparativo:**

| Escenario | Evals/dÃ­a | DÃ­as a JUNIOR (100) | DÃ­as a ESTABLISHED (500) |
|-----------|:---------:|:---:|:---:|
| 1 agente, sin pool | 10 | 10 | 50 |
| 5 agentes, pool compartido | 50 | 2 | 10 |
| 10 agentes, pool compartido | 100 | 1 | 5 |

La aceleraciÃ³n es legÃ­tima porque la pregunta es "Â¿cuÃ¡nta evidencia tengo sobre este runtime?", no "Â¿cuÃ¡nta evidencia tengo sobre este agente especÃ­fico?".

### 2.5 ComPi y Arquitectos en el mismo pool: Â¿problema?

ComPi es evaluado por Sergio (humano, gold standard). Los Arquitectos son evaluados por ComPi (agente, silver standard). Â¿Deben estar en el mismo pool?

**SÃ­.** Ambos usan `opus-4-6|high`. La pregunta del pool es "Â¿cÃ³mo rinde opus|high?" â€” ambos proveen evidencia. La calidad de la evaluaciÃ³n (humana vs agente) es una cuestiÃ³n de **pesos** en el cÃ¡lculo, no de separaciÃ³n de pools.

Para la v1: tratamiento igualitario (promedio simple de scores individuales). Para futuro: se puede ponderar por calidad de evaluador (`humanEval: weight 1.0`, `agentEval: weight 0.8`).

---

## 3. DecisiÃ³n

### Modelo: Pool-Based Scoring por Runtime

**Sin fases. Sin API central. Todo local. Implementable ahora.**

### 3.1 Principios

1. **Cada agente persistente tiene su propio `confidence.json`** â€” sigue las mismas reglas AICE (5 dominios, rachas, caps, warmup)
2. **Pool score = promedio ponderado por evaluaciones** de los scores individuales de los miembros
3. **Pool maturity = suma de evaluaciones** de todos los miembros del pool
4. **El pool es un archivo Ã­ndice** (`pool-index.json`) que se recalcula en cada evaluaciÃ³n
5. **EvaluaciÃ³n en cadena:** Sergioâ†’ComPi, ComPiâ†’Arquitectos, Arquitectosâ†’Equipo
6. **Registro individual para diagnÃ³stico:** cada agente tiene su historial de tareas/errores

### 3.2 QuÃ© resuelve vs ADR-047

| ADR-047 (Modelo D) | ADR-048 (Pool-Based) |
|---|---|
| Sub-agentes NO tienen score AICE | Sub-agentes SÃ tienen score AICE propio |
| `teamRegistry` centralizado en ComPi | Cada agente gestiona su propio archivo |
| Fases 1â†’2â†’3 (requiere servidor) | Sin fases, todo local |
| Reglas de atribuciÃ³n de culpa | No necesarias (cada agente tiene su evaluador) |
| Pool score inexistente | Pool score como mÃ©trica de runtime |
| Maturity solo de ComPi | Maturity compartida por pool |

---

## 4. Schema Completo

### 4.1 Estructura de Archivos

```
skills/aice/
  confidence.json                      # ComPi (agentId: compi)
  confidence-log.jsonl                 # ComPi evaluation log
  pool-index.json                      # Ãndice de todos los pools
  agents/
    architect-aice/
      confidence.json                  # Arquitecto AICE
      confidence-log.jsonl
    backend-aice/
      confidence.json                  # Backend Developer
      confidence-log.jsonl
    frontend-aice/
      confidence.json                  # Frontend Developer
      confidence-log.jsonl
    dataeng-aice/
      confidence.json
      confidence-log.jsonl
    tester-aice/
      confidence.json
      confidence-log.jsonl
```

### 4.2 Sub-Agent `confidence.json` (VersiÃ³n Ligera)

```json
{
  "version": 1,
  "schemaType": "subagent",
  "agentId": "backend-aice",
  "poolKey": "sonnet-4-5|high",
  "runtime": {
    "model": "anthropic/claude-sonnet-4-5",
    "thinking": "high"
  },
  "role": "backend",
  "project": "ai-confidence",
  "evaluatedBy": "architect-aice",
  "active": true,

  "domains": {
    "TECH":     { "score": 50, "streak": 0, "evaluations": 0, "corrections": 0 },
    "OPS":      { "score": 50, "streak": 0, "evaluations": 0, "corrections": 0 },
    "JUDGMENT": { "score": 50, "streak": 0, "evaluations": 0, "corrections": 0 },
    "COMMS":    { "score": 50, "streak": 0, "evaluations": 0, "corrections": 0 },
    "ORCH":     { "score": 50, "streak": 0, "evaluations": 0, "corrections": 0 }
  },
  "weights": { "TECH": 1.0, "OPS": 1.0, "JUDGMENT": 1.0, "COMMS": 1.0, "ORCH": 1.0 },
  "globalScore": 50,

  "warmup": {
    "active": true,
    "minEvaluations": 40,
    "minPerDomain": 6,
    "caps": { "positivePerDomain": 15, "negativePerDomain": -30 },
    "normalCaps": { "positivePerDomain": 10, "negativePerDomain": -20 }
  },

  "maturity": {
    "individualEvaluations": 0,
    "note": "Pool maturity en pool-index.json"
  },

  "dailyCap": -30,
  "dailyPositiveCap": 15,
  "dailyPenaltiesByDomain": { "TECH": 0, "OPS": 0, "JUDGMENT": 0, "COMMS": 0, "ORCH": 0 },
  "dailyBonusesByDomain": { "TECH": 0, "OPS": 0, "JUDGMENT": 0, "COMMS": 0, "ORCH": 0 },
  "dailyPenaltiesDate": "2026-02-23",
  "dailyStreakRewardsByDomain": { "TECH": 0, "OPS": 0, "JUDGMENT": 0, "COMMS": 0, "ORCH": 0 },

  "antiPatterns": [],
  "proPatterns": [],
  "lastEvaluation": null,
  "createdAt": "2026-02-23T15:00:00Z",
  "updatedAt": "2026-02-23T15:00:00Z"
}
```

**Diferencias vs confidence.json completo de ComPi:**

| Campo | ComPi | Sub-agente |
|-------|:-----:|:----------:|
| `schemaType` | (implÃ­cito "primary") | `"subagent"` |
| `poolKey` | (derivado) | ExplÃ­cito |
| `evaluatedBy` | Sergio (humano) | agentId del evaluador |
| `runtimeSnapshots` | âœ… (cambia de runtime) | âŒ (runtime fijo) |
| `selfAssessment` | âœ… (wizard) | âŒ (no necesario) |
| `params` | âœ… (8 core + style) | âŒ (hereda del pool/evaluador) |
| `role`, `project` | âŒ | âœ… |
| `active` | âŒ | âœ… (para marcar agentes archivados) |

### 4.3 `pool-index.json`

```json
{
  "version": 1,
  "description": "Ãndice de pools de confianza agrupados por runtime (modelo+thinking)",
  "pools": {
    "opus-4-6|high": {
      "runtime": {
        "model": "anthropic/claude-opus-4-6",
        "thinking": "high"
      },
      "members": [
        {
          "agentId": "compi",
          "role": "orchestrator",
          "evaluatedBy": "sergio (human)",
          "confidencePath": "skills/aice/confidence.json",
          "active": true
        },
        {
          "agentId": "architect-aice",
          "role": "architect",
          "evaluatedBy": "compi",
          "confidencePath": "skills/aice/agents/architect-aice/confidence.json",
          "active": true
        }
      ],
      "poolScore": 48.8,
      "poolScoreMethod": "weighted_avg_by_evals",
      "domainScores": {
        "TECH": 47.0,
        "OPS": 47.0,
        "JUDGMENT": 50.0,
        "COMMS": 50.0,
        "ORCH": 50.0
      },
      "maturity": {
        "totalEvaluations": 2,
        "tier": "GREEN",
        "tierLabel": "Nuevo",
        "tierEmoji": "ğŸ¥’",
        "confidenceInterval": 17.7,
        "baseUncertainty": 25
      },
      "lastUpdated": "2026-02-23T15:00:00Z"
    },
    "sonnet-4-5|high": {
      "runtime": {
        "model": "anthropic/claude-sonnet-4-5",
        "thinking": "high"
      },
      "members": [
        {
          "agentId": "backend-aice",
          "role": "backend",
          "evaluatedBy": "architect-aice",
          "confidencePath": "skills/aice/agents/backend-aice/confidence.json",
          "active": true
        },
        {
          "agentId": "frontend-aice",
          "role": "frontend",
          "evaluatedBy": "architect-aice",
          "confidencePath": "skills/aice/agents/frontend-aice/confidence.json",
          "active": true
        },
        {
          "agentId": "dataeng-aice",
          "role": "data-engineer",
          "evaluatedBy": "architect-aice",
          "confidencePath": "skills/aice/agents/dataeng-aice/confidence.json",
          "active": true
        },
        {
          "agentId": "tester-aice",
          "role": "tester",
          "evaluatedBy": "architect-aice",
          "confidencePath": "skills/aice/agents/tester-aice/confidence.json",
          "active": true
        }
      ],
      "poolScore": 50.0,
      "poolScoreMethod": "weighted_avg_by_evals",
      "domainScores": {
        "TECH": 50.0,
        "OPS": 50.0,
        "JUDGMENT": 50.0,
        "COMMS": 50.0,
        "ORCH": 50.0
      },
      "maturity": {
        "totalEvaluations": 0,
        "tier": "GREEN",
        "tierLabel": "Nuevo",
        "tierEmoji": "ğŸ¥’",
        "confidenceInterval": 25.0,
        "baseUncertainty": 25
      },
      "lastUpdated": "2026-02-23T15:00:00Z"
    }
  },
  "evaluationChain": {
    "sergio (human)": ["compi"],
    "compi": ["architect-aice"],
    "architect-aice": ["backend-aice", "frontend-aice", "dataeng-aice", "tester-aice"]
  },
  "lastUpdated": "2026-02-23T15:00:00Z"
}
```

### 4.4 CÃ¡lculo del Pool Score

```
pool_score(pool):
  members = pool.members.filter(active=true)
  
  if all members have 0 evaluations:
    return 50.0  # Default
  
  total_evals = sum(m.totalEvaluations for m in members)
  
  if total_evals == 0:
    return 50.0
  
  # Promedio ponderado por evaluaciones individuales
  weighted_sum = sum(m.globalScore * m.totalEvaluations for m in members)
  pool_score = weighted_sum / total_evals
  
  return round(pool_score, 1)
```

**Â¿Por quÃ© ponderado por evaluaciones y no promedio simple?**

- Un agente con 100 evals y score 82% tiene evidencia sÃ³lida.
- Un agente con 2 evals y score 50% estÃ¡ en default (no ha demostrado nada).
- Ponderar por evals da mÃ¡s peso a la evidencia sÃ³lida.
- Cuando todos tengan evaluaciones similares, converge al promedio simple.

**Pool domain scores:** Misma fÃ³rmula aplicada por dominio.

```
pool_domain_score(pool, domain):
  members = pool.members.filter(active=true)
  total_evals = sum(m.domains[domain].evaluations for m in members)
  
  if total_evals == 0:
    return 50.0
  
  weighted_sum = sum(m.domains[domain].score * m.domains[domain].evaluations for m in members)
  return round(weighted_sum / total_evals, 1)
```

### 4.5 CÃ¡lculo de Pool Maturity

```
pool_maturity(pool):
  members = pool.members.filter(active=true)
  total = sum(m.maturity.individualEvaluations for m in members)
  
  tier = GREEN   if total <= 100
       = JUNIOR  if total <= 500
       = ESTABLISHED if total <= 2000
       = MATURE  otherwise
  
  ci = round(baseUncertainty / sqrt(total), 1)  if total > 0 else baseUncertainty
  
  return { totalEvaluations: total, tier: tier, confidenceInterval: ci }
```

**Nota:** Los umbrales de tier (100/500/2000) son los mismos que para agentes individuales (SKILL.md Â§6.6). La diferencia es que el pool los alcanza mucho mÃ¡s rÃ¡pido.

### 4.6 Flujo de EvaluaciÃ³n

```
on_evaluation(evaluator, evaluatee, domain, result, severity):
  
  # 1. Actualizar confidence.json del evaluatee
  update_agent_confidence(evaluatee, domain, result, severity)
  # (Mismas reglas AICE: streaks, caps, daily limits, etc.)
  
  # 2. Escribir en confidence-log.jsonl del evaluatee
  append_eval_log(evaluatee, { evaluator, domain, result, severity, ... })
  
  # 3. Recalcular pool score
  pool = get_pool(evaluatee.poolKey)
  pool.poolScore = pool_score(pool)
  pool.domainScores = { d: pool_domain_score(pool, d) for d in DOMAINS }
  pool.maturity = pool_maturity(pool)
  pool.lastUpdated = now()
  
  # 4. Escribir pool-index.json
  save_pool_index()
```

### 4.7 Cadena de EvaluaciÃ³n EspecÃ­fica

| Evaluador | Evaluatee | MÃ©todo | Pool afectado |
|-----------|-----------|--------|---------------|
| Sergio (humano) | ComPi | ExplÃ­cito (`/aice rate`) + ImplÃ­cito (seÃ±ales) | opus-4-6\|high |
| ComPi | architect-aice | RevisiÃ³n de entregables del arquitecto | opus-4-6\|high |
| architect-aice | backend-aice | RevisiÃ³n de cÃ³digo/outputs | sonnet-4-5\|high |
| architect-aice | frontend-aice | RevisiÃ³n de cÃ³digo/outputs | sonnet-4-5\|high |
| architect-aice | dataeng-aice | RevisiÃ³n de pipelines/datos | sonnet-4-5\|high |
| architect-aice | tester-aice | RevisiÃ³n de tests/reportes | sonnet-4-5\|high |

**Regla:** Cada agente tiene exactamente UN evaluador. No hay evaluaciÃ³n cruzada en v1.

### 4.8 Ciclo de Vida de un Sub-Agente

```
CREACIÃ“N:
  1. Crear directorio skills/aice/agents/<agent-id>/
  2. Crear confidence.json con scores default (50% todos)
  3. Registrar en pool-index.json como member (active: true)
  4. Pool maturity no cambia (0 evals del nuevo agente)

EVALUACIÃ“N (normal):
  1. Evaluador revisa output del sub-agente
  2. Actualiza confidence.json del sub-agente
  3. Recalcula pool-index.json

DESACTIVACIÃ“N (proyecto termina):
  1. Marcar active: false en confidence.json del sub-agente
  2. Marcar active: false en pool-index.json member
  3. Los datos permanecen para historial
  4. El pool score se recalcula SIN este agente
  5. Las evaluaciones histÃ³ricas SIGUEN contando para pool maturity

REACTIVACIÃ“N:
  1. Marcar active: true
  2. Pool score incluye este agente de nuevo
```

---

## 5. Nuevos Comandos

| Comando | DescripciÃ³n |
|---------|-------------|
| `/aice pool` | Score y maturity de todos los pools |
| `/aice pool <poolKey>` | Detalle de un pool (miembros, scores individuales, maturity) |
| `/aice pool <poolKey> members` | Lista de miembros con scores individuales |
| `/aice team` | (Alias de `/aice pool` â€” retrocompatibilidad con ADR-047) |

**Ejemplo `/aice pool`:**

```
ğŸŠ AICE Pools
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

opus-4-6|high
  Pool Score: 48.8%  Â±17.7 | ğŸ¥’ Nuevo (2 evals)
  Miembros: compi (48.8%), architect-aice (50.0%)

sonnet-4-5|high
  Pool Score: 50.0%  Â±25.0 | ğŸ¥’ Nuevo (0 evals)
  Miembros: backend-aice, frontend-aice, dataeng-aice, tester-aice
  âš ï¸ Sin evaluaciones aÃºn
```

**Ejemplo `/aice pool sonnet-4-5|high members`:**

```
ğŸŠ Pool: sonnet-4-5|high
   Score: 72.3% Â±1.8 | ğŸŸ¡ Junior (195 evals)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Agente          â”‚ Score â”‚ Evals â”‚ ğŸ”§ TECH â”‚ âš™ï¸ OPS â”‚ ğŸ§  JDG â”‚ ğŸ’¬ COM â”‚ ğŸ¯ ORC
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€
backend-aice    â”‚  82%  â”‚   55  â”‚   88%   â”‚   80%  â”‚   78%  â”‚   75%  â”‚  N/A
frontend-aice   â”‚  55%  â”‚   45  â”‚   52%   â”‚   60%  â”‚   50%  â”‚   55%  â”‚  N/A
dataeng-aice    â”‚  71%  â”‚   50  â”‚   75%   â”‚   68%  â”‚   70%  â”‚   72%  â”‚  N/A
tester-aice     â”‚  78%  â”‚   45  â”‚   80%   â”‚   82%  â”‚   72%  â”‚   78%  â”‚  N/A
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš ï¸ frontend-aice: score 55% â€” revisar rendimiento
```

---

## 6. Impacto en Maturity (CÃ¡lculos)

### Escenario actual (sin pools)

ComPi solo, ~10 evals/dÃ­a:
- GREENâ†’JUNIOR: **10 dÃ­as**
- JUNIORâ†’ESTABLISHED: **40 dÃ­as**
- ESTABLISHEDâ†’MATURE: **150 dÃ­as**

### Con Pool opus-4-6|high (ComPi + 1 Arquitecto)

~10 evals/dÃ­a ComPi + ~8 evals/dÃ­a Arquitecto = ~18 evals/dÃ­a pool:
- GREENâ†’JUNIOR: **~6 dÃ­as** (1.7x mÃ¡s rÃ¡pido)
- JUNIORâ†’ESTABLISHED: **~22 dÃ­as** (1.8x)

### Con Pool sonnet-4-5|high (4 sub-agentes)

~8 evals/dÃ­a Ã— 4 agentes = ~32 evals/dÃ­a pool:
- GREENâ†’JUNIOR: **~3 dÃ­as** (3.3x mÃ¡s rÃ¡pido)
- JUNIORâ†’ESTABLISHED: **~13 dÃ­as** (3.8x)

### Con Pool sonnet crecido (10 sub-agentes entre proyectos)

~8 evals/dÃ­a Ã— 10 agentes = ~80 evals/dÃ­a pool:
- GREENâ†’JUNIOR: **~1.3 dÃ­as**
- JUNIORâ†’ESTABLISHED: **~5 dÃ­as**
- ESTABLISHEDâ†’MATURE: **~19 dÃ­as** (vs 150 dÃ­as sin pool)

**El PO tiene razÃ³n: la aceleraciÃ³n de madurez es el beneficio principal y es legÃ­tima.**

---

## 7. RelaciÃ³n con ADR-046 y ADR-047

### ADR-046 (Maturity per-runtime)

**Mantiene vigencia.** ADR-048 extiende la idea de maturity per-runtime a nivel de POOL. La maturity sigue siendo per-runtime, ahora compartida entre agentes del mismo runtime.

### ADR-047 (Subagent Trust Policy â€” Modelo D)

**Superada por ADR-048.** Diferencias clave:

| Aspecto | ADR-047 | ADR-048 |
|---------|---------|---------|
| Sub-agentes con score AICE | No (solo teamRegistry) | SÃ­ (confidence.json propio) |
| Pool de confianza | No existe | SÃ­, por runtime |
| Maturity compartida | No | SÃ­ |
| Fases de implementaciÃ³n | 3 fases | Sin fases |
| Servidor central requerido | SÃ­ (Fase 2+) | No |
| Reglas de atribuciÃ³n de culpa | DeterminÃ­sticas (Â§5.1) | No necesarias |
| teamRegistry en ComPi | SÃ­ | No (cada agente tiene su archivo) |

---

## 8. Consideraciones

### 8.1 Anti-Gaming

| Riesgo | MitigaciÃ³n |
|--------|-----------|
| ComPi infla scores de Arquitecto para subir pool opus | Pool score es promedio; la inflaciÃ³n del Arquitecto sube el pool, pero Sergio ve los individuales bajo demanda |
| Arquitecto infla scores de equipo Sonnet | Las evaluaciones son factuales (Â¿el output es correcto?). InflaciÃ³n detectable al revisar logs |
| Un agente "fantasma" para inflar maturity | Pool maturity requiere evaluaciones reales con logs. Sin evaluaciones no suma |

**Para v2 (futuro):** Sergio puede auditar `/aice pool <pool> members` y detectar anomalÃ­as.

### 8.2 Sub-agentes efÃ­meros vs persistentes

| Tipo | Registro en pool? | Ejemplo |
|------|:-:|---------|
| **Persistente** (>3 tareas, cross-sesiÃ³n) | âœ… | Arquitecto, Backend de un proyecto largo |
| **EfÃ­mero** (1-2 tareas, one-shot) | âŒ | Sub-agente para una tarea puntual |

Sub-agentes efÃ­meros no se registran en el pool (overhead > valor). Su trabajo afecta al score del evaluador que revisa su output.

### 8.3 Herencia de Pool Score para Nuevos Agentes

Cuando se crea un nuevo agente en un pool con maturity â‰¥ JUNIOR:

- **OpciÃ³n A (simple, recomendada v1):** Nuevo agente empieza en 50% (default AICE). El pool score ya refleja la experiencia acumulada.
- **OpciÃ³n B (futuro):** Nuevo agente hereda pool score como punto de partida. MÃ¡s sofisticado, Bayesian prior.

**v1: OpciÃ³n A.** Mantiene simplicidad. El pool score es la referencia de confianza; el score individual del agente nuevo converge con evaluaciones.

---

## 9. Resumen de la DecisiÃ³n

**Adoptar Pool-Based Scoring por Runtime:**

1. âœ… Cada sub-agente persistente tiene `confidence.json` propio (mismas reglas AICE)
2. âœ… Pool score = promedio ponderado por evaluaciones de los miembros
3. âœ… Pool maturity = suma de evaluaciones de todos los miembros
4. âœ… EvaluaciÃ³n en cadena: humanoâ†’principalâ†’arquitectosâ†’equipo
5. âœ… Pool-index.json como archivo de agregaciÃ³n
6. âœ… Sin fases, sin servidor, implementable ahora
7. âœ… Registro individual para diagnÃ³stico (quiÃ©n falla, en quÃ© dominio)

**ADR-047 queda superada.** El Modelo D con fases se reemplaza por pool-based scoring sin fases.

---

*Siguiente paso: ValidaciÃ³n del PO (Sergio). Si aprobado, crear los archivos iniciales (pool-index.json, confidence.json para cada sub-agente) y actualizar SKILL.md.*
